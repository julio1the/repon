[
  {
    "objectID": "juliovargas.html",
    "href": "juliovargas.html",
    "title": "Test Quarto Julio Vargas",
    "section": "",
    "text": "Importing Dataset using Pyspark. The code shows the schema and first rows of the dataset. Schema is shown below but partial dataframe is muted.\n\nfrom pyspark.sql import SparkSession\nfrom pyspark.sql.types import StructType\nimport json\n\nspark = SparkSession.builder.appName(\"JobPostingsAnalysis\").getOrCreate()\n\n# Load schema from JSON file\nwith open(\"data/schema_lightcast.json\") as f:\n    schema = StructType.fromJson(json.load(f))\n\ndf = (spark.read\n      .option(\"header\", \"true\")\n      .option(\"inferSchema\",\"false\")   \n      .schema(schema)              # saved schema\n      .option(\"multiLine\", \"true\")\n      .option(\"escape\", \"\\\"\")\n      .csv(\"data/lightcast_job_postings.csv\")\n      .limit(5000))\n\ndf.createOrReplaceTempView(\"jobs\")\n\n\n# save schema to pretty JSON\nimport json\n# convert schema to dict first\nschema_dict = df.schema.jsonValue()\n# write it nicely formatted (indent=2 gives pretty print)\nwith open(\"data/schema_lightcast.json\", \"w\") as f:\n    json.dump(schema_dict, f, indent=2)\n\n\ndf.printSchema()\n\n\n# Count total rows in the DataFrame\nrow_count = df.count()\nprint(row_count)\n\nWARNING: Using incubator modules: jdk.incubator.vector\nUsing Spark's default log4j profile: org/apache/spark/log4j2-defaults.properties\nSetting default log level to \"WARN\".\nTo adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).\n25/09/21 04:37:39 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\n25/09/21 04:37:45 WARN SparkStringUtils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.\n\n\nroot\n |-- ID: string (nullable = true)\n |-- LAST_UPDATED_DATE: string (nullable = true)\n |-- LAST_UPDATED_TIMESTAMP: timestamp (nullable = true)\n |-- DUPLICATES: integer (nullable = true)\n |-- POSTED: string (nullable = true)\n |-- EXPIRED: string (nullable = true)\n |-- DURATION: integer (nullable = true)\n |-- SOURCE_TYPES: string (nullable = true)\n |-- SOURCES: string (nullable = true)\n |-- URL: string (nullable = true)\n |-- ACTIVE_URLS: string (nullable = true)\n |-- ACTIVE_SOURCES_INFO: string (nullable = true)\n |-- TITLE_RAW: string (nullable = true)\n |-- BODY: string (nullable = true)\n |-- MODELED_EXPIRED: string (nullable = true)\n |-- MODELED_DURATION: integer (nullable = true)\n |-- COMPANY: integer (nullable = true)\n |-- COMPANY_NAME: string (nullable = true)\n |-- COMPANY_RAW: string (nullable = true)\n |-- COMPANY_IS_STAFFING: boolean (nullable = true)\n |-- EDUCATION_LEVELS: string (nullable = true)\n |-- EDUCATION_LEVELS_NAME: string (nullable = true)\n |-- MIN_EDULEVELS: integer (nullable = true)\n |-- MIN_EDULEVELS_NAME: string (nullable = true)\n |-- MAX_EDULEVELS: integer (nullable = true)\n |-- MAX_EDULEVELS_NAME: string (nullable = true)\n |-- EMPLOYMENT_TYPE: integer (nullable = true)\n |-- EMPLOYMENT_TYPE_NAME: string (nullable = true)\n |-- MIN_YEARS_EXPERIENCE: integer (nullable = true)\n |-- MAX_YEARS_EXPERIENCE: integer (nullable = true)\n |-- IS_INTERNSHIP: boolean (nullable = true)\n |-- SALARY: integer (nullable = true)\n |-- REMOTE_TYPE: integer (nullable = true)\n |-- REMOTE_TYPE_NAME: string (nullable = true)\n |-- ORIGINAL_PAY_PERIOD: string (nullable = true)\n |-- SALARY_TO: integer (nullable = true)\n |-- SALARY_FROM: integer (nullable = true)\n |-- LOCATION: string (nullable = true)\n |-- CITY: string (nullable = true)\n |-- CITY_NAME: string (nullable = true)\n |-- COUNTY: integer (nullable = true)\n |-- COUNTY_NAME: string (nullable = true)\n |-- MSA: integer (nullable = true)\n |-- MSA_NAME: string (nullable = true)\n |-- STATE: integer (nullable = true)\n |-- STATE_NAME: string (nullable = true)\n |-- COUNTY_OUTGOING: integer (nullable = true)\n |-- COUNTY_NAME_OUTGOING: string (nullable = true)\n |-- COUNTY_INCOMING: integer (nullable = true)\n |-- COUNTY_NAME_INCOMING: string (nullable = true)\n |-- MSA_OUTGOING: integer (nullable = true)\n |-- MSA_NAME_OUTGOING: string (nullable = true)\n |-- MSA_INCOMING: integer (nullable = true)\n |-- MSA_NAME_INCOMING: string (nullable = true)\n |-- NAICS2: integer (nullable = true)\n |-- NAICS2_NAME: string (nullable = true)\n |-- NAICS3: integer (nullable = true)\n |-- NAICS3_NAME: string (nullable = true)\n |-- NAICS4: integer (nullable = true)\n |-- NAICS4_NAME: string (nullable = true)\n |-- NAICS5: integer (nullable = true)\n |-- NAICS5_NAME: string (nullable = true)\n |-- NAICS6: integer (nullable = true)\n |-- NAICS6_NAME: string (nullable = true)\n |-- TITLE: string (nullable = true)\n |-- TITLE_NAME: string (nullable = true)\n |-- TITLE_CLEAN: string (nullable = true)\n |-- SKILLS: string (nullable = true)\n |-- SKILLS_NAME: string (nullable = true)\n |-- SPECIALIZED_SKILLS: string (nullable = true)\n |-- SPECIALIZED_SKILLS_NAME: string (nullable = true)\n |-- CERTIFICATIONS: string (nullable = true)\n |-- CERTIFICATIONS_NAME: string (nullable = true)\n |-- COMMON_SKILLS: string (nullable = true)\n |-- COMMON_SKILLS_NAME: string (nullable = true)\n |-- SOFTWARE_SKILLS: string (nullable = true)\n |-- SOFTWARE_SKILLS_NAME: string (nullable = true)\n |-- ONET: string (nullable = true)\n |-- ONET_NAME: string (nullable = true)\n |-- ONET_2019: string (nullable = true)\n |-- ONET_2019_NAME: string (nullable = true)\n |-- CIP6: string (nullable = true)\n |-- CIP6_NAME: string (nullable = true)\n |-- CIP4: string (nullable = true)\n |-- CIP4_NAME: string (nullable = true)\n |-- CIP2: string (nullable = true)\n |-- CIP2_NAME: string (nullable = true)\n |-- SOC_2021_2: string (nullable = true)\n |-- SOC_2021_2_NAME: string (nullable = true)\n |-- SOC_2021_3: string (nullable = true)\n |-- SOC_2021_3_NAME: string (nullable = true)\n |-- SOC_2021_4: string (nullable = true)\n |-- SOC_2021_4_NAME: string (nullable = true)\n |-- SOC_2021_5: string (nullable = true)\n |-- SOC_2021_5_NAME: string (nullable = true)\n |-- LOT_CAREER_AREA: integer (nullable = true)\n |-- LOT_CAREER_AREA_NAME: string (nullable = true)\n |-- LOT_OCCUPATION: integer (nullable = true)\n |-- LOT_OCCUPATION_NAME: string (nullable = true)\n |-- LOT_SPECIALIZED_OCCUPATION: integer (nullable = true)\n |-- LOT_SPECIALIZED_OCCUPATION_NAME: string (nullable = true)\n |-- LOT_OCCUPATION_GROUP: integer (nullable = true)\n |-- LOT_OCCUPATION_GROUP_NAME: string (nullable = true)\n |-- LOT_V6_SPECIALIZED_OCCUPATION: integer (nullable = true)\n |-- LOT_V6_SPECIALIZED_OCCUPATION_NAME: string (nullable = true)\n |-- LOT_V6_OCCUPATION: integer (nullable = true)\n |-- LOT_V6_OCCUPATION_NAME: string (nullable = true)\n |-- LOT_V6_OCCUPATION_GROUP: integer (nullable = true)\n |-- LOT_V6_OCCUPATION_GROUP_NAME: string (nullable = true)\n |-- LOT_V6_CAREER_AREA: integer (nullable = true)\n |-- LOT_V6_CAREER_AREA_NAME: string (nullable = true)\n |-- SOC_2: string (nullable = true)\n |-- SOC_2_NAME: string (nullable = true)\n |-- SOC_3: string (nullable = true)\n |-- SOC_3_NAME: string (nullable = true)\n |-- SOC_4: string (nullable = true)\n |-- SOC_4_NAME: string (nullable = true)\n |-- SOC_5: string (nullable = true)\n |-- SOC_5_NAME: string (nullable = true)\n |-- LIGHTCAST_SECTORS: string (nullable = true)\n |-- LIGHTCAST_SECTORS_NAME: string (nullable = true)\n |-- NAICS_2022_2: integer (nullable = true)\n |-- NAICS_2022_2_NAME: string (nullable = true)\n |-- NAICS_2022_3: integer (nullable = true)\n |-- NAICS_2022_3_NAME: string (nullable = true)\n |-- NAICS_2022_4: integer (nullable = true)\n |-- NAICS_2022_4_NAME: string (nullable = true)\n |-- NAICS_2022_5: integer (nullable = true)\n |-- NAICS_2022_5_NAME: string (nullable = true)\n |-- NAICS_2022_6: integer (nullable = true)\n |-- NAICS_2022_6_NAME: string (nullable = true)\n\n\n\n[Stage 0:&gt;                                                          (0 + 1) / 1]\n\n\n5000"
  },
  {
    "objectID": "juliovargas.html#example",
    "href": "juliovargas.html#example",
    "title": "Test Quarto Julio Vargas",
    "section": "2.1 Example",
    "text": "2.1 Example\nLetâ€™s get 5 rows of id, title, and company_name from the job postings table.\n\nspark.sql(\"SELECT ID AS job_id, title_raw FROM jobs LIMIT 5\").show(truncate=False)\n\n+----------------------------------------+------------------------------------------------------------+\n|job_id                                  |title_raw                                                   |\n+----------------------------------------+------------------------------------------------------------+\n|1f57d95acf4dc67ed2819eb12f049f6a5c11782c|Enterprise Analyst (II-III)                                 |\n|0cb072af26757b6c4ea9464472a50a443af681ac|Oracle Consultant - Reports (3592)                          |\n|85318b12b3331fa490d32ad014379df01855c557|Data Analyst                                                |\n|1b5c3941e54a1889ef4f8ae55b401a550708a310|Sr. Lead Data Mgmt. Analyst - SAS Product Owner             |\n|cb5ca25f02bdf25c13edfede7931508bfd9e858f|Comisiones de $1000 - $3000 por semana... Comiensa Rapido!!!|\n+----------------------------------------+------------------------------------------------------------+"
  },
  {
    "objectID": "juliovargas.html#locations-table",
    "href": "juliovargas.html#locations-table",
    "title": "Test Quarto Julio Vargas",
    "section": "2.2 Locations Table",
    "text": "2.2 Locations Table\nLets extract columns from the main dataframe to create a locations table. The columns are as follows:\nI also sorted the locations table by MSA in ascending order and then added a location_id as primary key.\nLOCATION_ID (PK), LOCATION, CITY_NAME, STATE_NAME, COUNTY_NAME, MSA, MSA_NAME.\n\nfrom pyspark.sql.functions import col, monotonically_increasing_id\n\n# using inbuilt pyspark select\n# locations_df = df.select(\n#     col(\"location\"),\n#     col(\"city_name\"),\n#     col(\"state_name\"),\n#     col(\"county_name\"),\n#     col(\"msa\"),\n#     col(\"msa_name\")\n# ).distinct().withColumn(\"location_id\", monotonically_increasing_id())\n\n#alternative using selectExpr\nlocations_df = df.selectExpr(\"monotonically_increasing_id() AS LOCATION_ID\",\n                             \"location\",\n                             \"city_name\",\n                             \"state_name\",\n                             \"county_name\",\n                             \"msa\",\n                             \"msa_name\")\n\nlocations_df.createOrReplaceTempView(\"locations\")\n\nlocations_df.show(truncate=False)\n\n[Stage 4:&gt;                                                          (0 + 1) / 1]\n\n\n+-----------+-------------------------------------------------+------------------+-------------+--------------------+-----+-------------------------------------+\n|LOCATION_ID|location                                         |city_name         |state_name   |county_name         |msa  |msa_name                             |\n+-----------+-------------------------------------------------+------------------+-------------+--------------------+-----+-------------------------------------+\n|0          |{\\n  \"lat\": 33.20763,\\n  \"lon\": -92.6662674\\n}   |El Dorado, AR     |Arkansas     |Union, AR           |20980|El Dorado, AR                        |\n|1          |{\\n  \"lat\": 44.3106241,\\n  \"lon\": -69.7794897\\n} |Augusta, ME       |Maine        |Kennebec, ME        |12300|Augusta-Waterville, ME               |\n|2          |{\\n  \"lat\": 32.7766642,\\n  \"lon\": -96.7969879\\n} |Dallas, TX        |Texas        |Dallas, TX          |19100|Dallas-Fort Worth-Arlington, TX      |\n|3          |{\\n  \"lat\": 33.4483771,\\n  \"lon\": -112.0740373\\n}|Phoenix, AZ       |Arizona      |Maricopa, AZ        |38060|Phoenix-Mesa-Chandler, AZ            |\n|4          |{\\n  \"lat\": 37.6392595,\\n  \"lon\": -120.9970014\\n}|Modesto, CA       |California   |Stanislaus, CA      |33700|Modesto, CA                          |\n|5          |{\\n  \"lat\": 0,\\n  \"lon\": 0\\n}                    |[Unknown City], AR|Arkansas     |[Unknown county], AR|NULL |NULL                                 |\n|6          |{\\n  \"lat\": 33.4941704,\\n  \"lon\": -111.9260519\\n}|Scottsdale, AZ    |Arizona      |Maricopa, AZ        |38060|Phoenix-Mesa-Chandler, AZ            |\n|7          |{\\n  \"lat\": 39.7589478,\\n  \"lon\": -84.1916069\\n} |Dayton, OH        |Ohio         |Montgomery, OH      |19430|Dayton-Kettering, OH                 |\n|8          |{\\n  \"lat\": 41.1220409,\\n  \"lon\": -74.5804378\\n} |Franklin, NJ      |New Jersey   |Sussex, NJ          |35620|New York-Newark-Jersey City, NY-NJ-PA|\n|9          |{\\n  \"lat\": 40.7501,\\n  \"lon\": -73.997\\n}        |New York, NY      |New York     |New York, NY        |35620|New York-Newark-Jersey City, NY-NJ-PA|\n|10         |{\\n  \"lat\": 35.6224561,\\n  \"lon\": -117.6708966\\n}|Ridgecrest, CA    |California   |Kern, CA            |12540|Bakersfield, CA                      |\n|11         |{\\n  \"lat\": 21.3069444,\\n  \"lon\": -157.8583333\\n}|Honolulu, HI      |Hawaii       |Honolulu, HI        |46520|Urban Honolulu, HI                   |\n|12         |{\\n  \"lat\": 0,\\n  \"lon\": 0\\n}                    |[Unknown City], GA|Georgia      |[Unknown county], GA|NULL |NULL                                 |\n|13         |{\\n  \"lat\": 42.331427,\\n  \"lon\": -83.0457538\\n}  |Detroit, MI       |Michigan     |Wayne, MI           |19820|Detroit-Warren-Dearborn, MI          |\n|14         |{\\n  \"lat\": 32.2987573,\\n  \"lon\": -90.1848103\\n} |Jackson, MS       |Mississippi  |Hinds, MS           |27140|Jackson, MS                          |\n|15         |{\\n  \"lat\": 42.3600825,\\n  \"lon\": -71.0588801\\n} |Boston, MA        |Massachusetts|Suffolk, MA         |14460|Boston-Cambridge-Newton, MA-NH       |\n|16         |{\\n  \"lat\": 0,\\n  \"lon\": 0\\n}                    |[Unknown City], AZ|Arizona      |[Unknown county], AZ|NULL |NULL                                 |\n|17         |{\\n  \"lat\": 58.3019444,\\n  \"lon\": -134.4197221\\n}|Juneau, AK        |Alaska       |Juneau Borough, AK  |27940|Juneau, AK                           |\n|18         |{\\n  \"lat\": 33.5185892,\\n  \"lon\": -86.8103567\\n} |Birmingham, AL    |Alabama      |Jefferson, AL       |13820|Birmingham-Hoover, AL                |\n|19         |{\\n  \"lat\": 37.7749295,\\n  \"lon\": -122.4194155\\n}|San Francisco, CA |California   |San Francisco, CA   |41860|San Francisco-Oakland-Berkeley, CA   |\n+-----------+-------------------------------------------------+------------------+-------------+--------------------+-----+-------------------------------------+\nonly showing top 20 rows"
  },
  {
    "objectID": "juliovargas.html#industries-table",
    "href": "juliovargas.html#industries-table",
    "title": "Test Quarto Julio Vargas",
    "section": "2.3 Industries Table",
    "text": "2.3 Industries Table\nindustries INDUSTRY_ID (Primary Key), NAICS_2022_6, NAICS_2022_6_NAME, SOC_5, SOC_5_NAME, LOT_SPECIALIZED_OCCUPATION_NAME, LOT_OCCUPATION_GROUP\n\nindustries_df = df.selectExpr(\"monotonically_increasing_id() AS INDUSTRY_ID\",\n                              \"naics_2022_4\",\n                              \"naics_2022_4_name\",\n                              \"naics_2022_5\",\n                              \"naics_2022_5_name\",\n                              \"naics_2022_6\",\n                              \"naics_2022_6_name\",\n                              \"soc_5 AS SOC_5\",\n                              \"soc_5_name AS SOC_5_NAME\",\n                              \"lot_specialized_occupation_name\",\n                              \"lot_occupation_group\")\n\nindustries_df.createOrReplaceTempView(\"industries\")\n\nindustries_df.show(truncate=False)\n\n[Stage 7:&gt;                                                          (0 + 1) / 1]                                                                                \n\n\n+-----------+------------+------------------------------------------------------------+------------+------------------------------------------------------------------------+------------+------------------------------------------------------------------------+-------+---------------+--------------------------------+--------------------+\n|INDUSTRY_ID|naics_2022_4|naics_2022_4_name                                           |naics_2022_5|naics_2022_5_name                                                       |naics_2022_6|naics_2022_6_name                                                       |SOC_5  |SOC_5_NAME     |lot_specialized_occupation_name |lot_occupation_group|\n+-----------+------------+------------------------------------------------------------+------------+------------------------------------------------------------------------+------------+------------------------------------------------------------------------+-------+---------------+--------------------------------+--------------------+\n|0          |4413        |Automotive Parts, Accessories, and Tire Retailers           |44133       |Automotive Parts and Accessories Retailers                              |441330      |Automotive Parts and Accessories Retailers                              |15-2051|Data Scientists|General ERP Analyst / Consultant|2310                |\n|1          |5613        |Employment Services                                         |56132       |Temporary Help Services                                                 |561320      |Temporary Help Services                                                 |15-2051|Data Scientists|Oracle Consultant / Analyst     |2310                |\n|2          |5242        |Agencies, Brokerages, and Other Insurance Related Activities|52429       |Other Insurance Related Activities                                      |524291      |Claims Adjusting                                                        |15-2051|Data Scientists|Data Analyst                    |2311                |\n|3          |5221        |Depository Credit Intermediation                            |52211       |Commercial Banking                                                      |522110      |Commercial Banking                                                      |15-2051|Data Scientists|Data Analyst                    |2311                |\n|4          |9999        |Unclassified Industry                                       |99999       |Unclassified Industry                                                   |999999      |Unclassified Industry                                                   |15-2051|Data Scientists|Oracle Consultant / Analyst     |2310                |\n|5          |5178        |All Other Telecommunications                                |51781       |All Other Telecommunications                                            |517810      |All Other Telecommunications                                            |15-2051|Data Scientists|Data Analyst                    |2311                |\n|6          |3344        |Semiconductor and Other Electronic Component Manufacturing  |33441       |Semiconductor and Other Electronic Component Manufacturing              |334413      |Semiconductor and Related Device Manufacturing                          |15-2051|Data Scientists|Data Analyst                    |2311                |\n|7          |5242        |Agencies, Brokerages, and Other Insurance Related Activities|52429       |Other Insurance Related Activities                                      |524291      |Claims Adjusting                                                        |15-2051|Data Scientists|Data Analyst                    |2311                |\n|8          |9999        |Unclassified Industry                                       |99999       |Unclassified Industry                                                   |999999      |Unclassified Industry                                                   |15-2051|Data Scientists|General ERP Analyst / Consultant|2310                |\n|9          |5415        |Computer Systems Design and Related Services                |54151       |Computer Systems Design and Related Services                            |541511      |Custom Computer Programming Services                                    |15-2051|Data Scientists|Data Analyst                    |2311                |\n|10         |4238        |Machinery, Equipment, and Supplies Merchant Wholesalers     |42383       |Industrial Machinery and Equipment Merchant Wholesalers                 |423830      |Industrial Machinery and Equipment Merchant Wholesalers                 |15-2051|Data Scientists|Data Analyst                    |2311                |\n|11         |5613        |Employment Services                                         |56132       |Temporary Help Services                                                 |561320      |Temporary Help Services                                                 |15-2051|Data Scientists|Data Analyst                    |2311                |\n|12         |5223        |Activities Related to Credit Intermediation                 |52232       |Financial Transactions Processing, Reserve, and Clearinghouse Activities|522320      |Financial Transactions Processing, Reserve, and Clearinghouse Activities|15-2051|Data Scientists|Data Analyst                    |2311                |\n|13         |5416        |Management, Scientific, and Technical Consulting Services   |54161       |Management Consulting Services                                          |541611      |Administrative Management and General Management Consulting Services    |15-2051|Data Scientists|General ERP Analyst / Consultant|2310                |\n|14         |5239        |Other Financial Investment Activities                       |52394       |Portfolio Management and Investment Advice                              |523940      |Portfolio Management and Investment Advice                              |15-2051|Data Scientists|Enterprise Architect            |2315                |\n|15         |6113        |Colleges, Universities, and Professional Schools            |61131       |Colleges, Universities, and Professional Schools                        |611310      |Colleges, Universities, and Professional Schools                        |15-2051|Data Scientists|Data Analyst                    |2311                |\n|16         |5415        |Computer Systems Design and Related Services                |54151       |Computer Systems Design and Related Services                            |541512      |Computer Systems Design Services                                        |15-2051|Data Scientists|General ERP Analyst / Consultant|2310                |\n|17         |5613        |Employment Services                                         |56132       |Temporary Help Services                                                 |561320      |Temporary Help Services                                                 |15-2051|Data Scientists|Oracle Consultant / Analyst     |2310                |\n|18         |6214        |Outpatient Care Centers                                     |62149       |Other Outpatient Care Centers                                           |621493      |Freestanding Ambulatory Surgical and Emergency Centers                  |15-2051|Data Scientists|Enterprise Architect            |2315                |\n|19         |9999        |Unclassified Industry                                       |99999       |Unclassified Industry                                                   |999999      |Unclassified Industry                                                   |15-2051|Data Scientists|Data Analyst                    |2311                |\n+-----------+------------+------------------------------------------------------------+------------+------------------------------------------------------------------------+------------+------------------------------------------------------------------------+-------+---------------+--------------------------------+--------------------+\nonly showing top 20 rows"
  },
  {
    "objectID": "juliovargas.html#companies-table",
    "href": "juliovargas.html#companies-table",
    "title": "Test Quarto Julio Vargas",
    "section": "2.4 Companies Table",
    "text": "2.4 Companies Table\n\n# \n# Step 1: Create Companies Table (Primary Key: company_id)\ncompanies_df = df.select(\n    col(\"company\"),\n    col(\"company_name\"),\n    col(\"company_raw\"),\n    col(\"company_is_staffing\")\n).distinct().withColumn(\"company_id\", monotonically_increasing_id())\n# companies_df.show(5)\ncompanies = companies_df.toPandas()\ncompanies.drop(columns=[\"company\"], inplace=True)\ncompanies.rename(columns={\"company_is_staffing\": \"is_staffing\"},\ninplace=True)\ncompanies.to_csv(\"./output/companies.csv\", index=False)\ncompanies.head()\n\n\n\n\n\n\n\n\ncompany_name\ncompany_raw\nis_staffing\ncompany_id\n\n\n\n\n0\nMurphy USA\nMurphy USA\nFalse\n0\n\n\n1\nSmx Corporation Limited\nSMX\nTrue\n1\n\n\n2\nSedgwick\nSedgwick\nFalse\n2\n\n\n3\nWells Fargo\nWells Fargo\nFalse\n3\n\n\n4\nUnclassified\nLH/GM\nFalse\n4"
  },
  {
    "objectID": "juliovargas.html#job-postings-table",
    "href": "juliovargas.html#job-postings-table",
    "title": "Test Quarto Julio Vargas",
    "section": "2.5 Job postings Table",
    "text": "2.5 Job postings Table\n\n# Step 4: Create Job Postings Table (Adding Foreign Keys)\njob_postings_df = df.select(\n    col(\"id\").alias(\"job_id\"),\n    col(\"title_clean\"),\n    col(\"body\"),\n    col(\"company\"),\n    col(\"employment_type_name\"),\n    col(\"remote_type_name\"),\n    col(\"min_years_experience\"),\n    col(\"max_years_experience\"),\n    col(\"salary\"),\n    col(\"salary_from\"),\n    col(\"salary_to\"),\n    col(\"location\"),\n    col(\"naics_2022_6\"),\n    col(\"posted\"),\n    col(\"expired\"),\n    col(\"duration\")\n)\n\njob_postings_df.show(5)\n\n+--------------------+--------------------+--------------------+--------+--------------------+----------------+--------------------+--------------------+------+-----------+---------+--------------------+------------+--------+---------+--------+\n|              job_id|         title_clean|                body| company|employment_type_name|remote_type_name|min_years_experience|max_years_experience|salary|salary_from|salary_to|            location|naics_2022_6|  posted|  expired|duration|\n+--------------------+--------------------+--------------------+--------+--------------------+----------------+--------------------+--------------------+------+-----------+---------+--------------------+------------+--------+---------+--------+\n|1f57d95acf4dc67ed...|enterprise analys...|31-May-2024\\n\\nEn...|  894731|Full-time (&gt; 32 h...|          [None]|                   2|                   2|  NULL|       NULL|     NULL|{\\n  \"lat\": 33.20...|      441330|6/2/2024| 6/8/2024|       6|\n|0cb072af26757b6c4...|oracle consultant...|Oracle Consultant...|  133098|Full-time (&gt; 32 h...|          Remote|                   3|                   3|  NULL|       NULL|     NULL|{\\n  \"lat\": 44.31...|      561320|6/2/2024| 8/1/2024|    NULL|\n|85318b12b3331fa49...|        data analyst|Taking care of pe...|39063746|Full-time (&gt; 32 h...|          [None]|                   5|                NULL|  NULL|       NULL|     NULL|{\\n  \"lat\": 32.77...|      524291|6/2/2024| 7/7/2024|      35|\n|1b5c3941e54a1889e...|sr lead data mgmt...|About this role:\\...|37615159|Full-time (&gt; 32 h...|          [None]|                   3|                NULL|  NULL|       NULL|     NULL|{\\n  \"lat\": 33.44...|      522110|6/2/2024|7/20/2024|      48|\n|cb5ca25f02bdf25c1...|comisiones de por...|Comisiones de $10...|       0|Part-time / full-...|          [None]|                NULL|                NULL| 92500|      35000|   150000|{\\n  \"lat\": 37.63...|      999999|6/2/2024|6/17/2024|      15|\n+--------------------+--------------------+--------------------+--------+--------------------+----------------+--------------------+--------------------+------+-----------+---------+--------------------+------------+--------+---------+--------+\nonly showing top 5 rows\n\n\nAdding Foreign keys to job postings table\n\n# Join with Companies Table to get company_id\njob_postings_df = job_postings_df.join(companies_df.select(\"company\", \"company_id\"), on=\"company\", how=\"left\")\n\n# Join with Locations Table to get location_id\njob_postings_df = job_postings_df.join(locations_df.select(\"location\", \"location_id\"), job_postings_df.location == locations_df[\"location\"],\nhow=\"left\").drop(\"location\")\n\n# Join with Industries Table to get industry_id\njob_postings_df = job_postings_df.join(industries_df.select(\"naics_2022_6\", \"industry_id\"),\n job_postings_df.naics_2022_6 == industries_df.naics_2022_6,\n how=\"left\").drop(\"naics_2022_6\")\n\n# Drop redundant columns\njob_postings_df = job_postings_df.drop(\"company\", \"lat-long\")\njob_postings_df.createOrReplaceTempView(\"job_postings\")\n\n# Show final job_postings_df structure\njob_postings_df.show(5)\n\n25/09/21 04:37:55 WARN Column: Constructing trivially true equals predicate, 'location == location'. Perhaps you need to use aliases.\n25/09/21 04:37:55 WARN Column: Constructing trivially true equals predicate, 'naics_2022_6 == naics_2022_6'. Perhaps you need to use aliases.\n[Stage 14:&gt;   (0 + 1) / 1][Stage 15:&gt;   (0 + 1) / 1][Stage 16:&gt;   (0 + 0) / 1][Stage 14:&gt;                 (0 + 1) / 1][Stage 16:&gt;                 (0 + 1) / 1][Stage 16:&gt;                                                         (0 + 1) / 1]                                                                                \n\n\n+--------------------+--------------------+--------------------+--------------------+----------------+--------------------+--------------------+------+-----------+---------+--------+--------+--------+----------+-----------+-----------+\n|              job_id|         title_clean|                body|employment_type_name|remote_type_name|min_years_experience|max_years_experience|salary|salary_from|salary_to|  posted| expired|duration|company_id|location_id|industry_id|\n+--------------------+--------------------+--------------------+--------------------+----------------+--------------------+--------------------+------+-----------+---------+--------+--------+--------+----------+-----------+-----------+\n|1f57d95acf4dc67ed...|enterprise analys...|31-May-2024\\n\\nEn...|Full-time (&gt; 32 h...|          [None]|                   2|                   2|  NULL|       NULL|     NULL|6/2/2024|6/8/2024|       6|         0|       1399|       4561|\n|1f57d95acf4dc67ed...|enterprise analys...|31-May-2024\\n\\nEn...|Full-time (&gt; 32 h...|          [None]|                   2|                   2|  NULL|       NULL|     NULL|6/2/2024|6/8/2024|       6|         0|       1399|       2770|\n|1f57d95acf4dc67ed...|enterprise analys...|31-May-2024\\n\\nEn...|Full-time (&gt; 32 h...|          [None]|                   2|                   2|  NULL|       NULL|     NULL|6/2/2024|6/8/2024|       6|         0|       1399|       1399|\n|1f57d95acf4dc67ed...|enterprise analys...|31-May-2024\\n\\nEn...|Full-time (&gt; 32 h...|          [None]|                   2|                   2|  NULL|       NULL|     NULL|6/2/2024|6/8/2024|       6|         0|       1399|          0|\n|1f57d95acf4dc67ed...|enterprise analys...|31-May-2024\\n\\nEn...|Full-time (&gt; 32 h...|          [None]|                   2|                   2|  NULL|       NULL|     NULL|6/2/2024|6/8/2024|       6|         0|          0|       4561|\n+--------------------+--------------------+--------------------+--------------------+----------------+--------------------+--------------------+------+-----------+---------+--------+--------+--------+----------+-----------+-----------+\nonly showing top 5 rows"
  }
]